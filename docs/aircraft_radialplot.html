<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Aircraft Hierarchy Radial Plot</title>
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
    }
    #vis {
      width: 100vw;
      height: 100vh;
    }
  </style>
</head>
<body>
  <div id="vis"></div>
  <script type="text/javascript">
    const spec = {
      "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
      "description": "Aircraft hierarchy by manufacturer, family, and variant.",
      "data": {
        "values": [
          {
            "name": "Aircraft",
            "children": [
              {
                "name": "Boeing",
                "children": [
                  {
                    "name": "737",
                    "children": [
                      {"name": "737-700", "size": 1},
                      {"name": "737-800", "size": 1},
                      {"name": "737 MAX", "size": 1}
                    ]
                  },
                  {
                    "name": "777",
                    "children": [
                      {"name": "777-200", "size": 1},
                      {"name": "777-300", "size": 1}
                    ]
                  }
                ]
              },
              {
                "name": "Airbus",
                "children": [
                  {
                    "name": "A320",
                    "children": [
                      {"name": "A320ceo", "size": 1},
                      {"name": "A320neo", "size": 1}
                    ]
                  },
                  {
                    "name": "A350",
                    "children": [
                      {"name": "A350-900", "size": 1},
                      {"name": "A350-1000", "size": 1}
                    ]
                  }
                ]
              }
            ]
          }
        ]
      },
      "mark": "arc",
      "encoding": {
        "theta": {"field": "x", "type": "quantitative", "stack": true},
        "radius": {"field": "depth", "type": "ordinal"},
        "color": {"field": "name", "type": "nominal"},
        "tooltip": {"field": "name"}
      },
      "transform": [
        {
          "flatten": ["children"]
        },
        {
          "window": [{"op": "rank", "as": "x"}]
        },
        {
          "calculate": "1", "as": "depth"
        }
      ],
      "view": {"stroke": null},
      "width": "container",
      "height": "container"
    };

    const embedOpt = { mode: "vega-lite", actions: false };

    vegaEmbed("#vis", spec, embedOpt).catch(error => {
      const el = document.getElementById("vis");
      el.innerHTML = `
        <div style="color:red; padding:1em;">
          <h3>JavaScript Error: ${error.message}</h3>
          <p>This usually means there's a typo in your chart specification.</p>
          <pre>${error.stack}</pre>
        </div>
      `;
      throw error;
    });
  </script>
</body>
</html>
